GRANT CREATE ANY DIRECTORY TO MYAIR_SCHEMA;
GRANT DROP ANY DIRECTORY TO MYAIR_SCHEMA;
GRANT EXECUTE ON UTL_FILE TO MYAIR_SCHEMA;
drop table Airport;
CREATE TABLE Airport (
  airport_id NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  airport_name NVARCHAR2(60) NOT NULL,
  location_country NVARCHAR2(40) NOT NULL,
  location_city NVARCHAR2(40) NOT NULL
);

INSERT INTO Airport (airport_name, location_country, location_city)
VALUES ('London Heathrow Airport', 'United Kingdom', 'London');

GRANT CTXAPP TO MYAIR_SCHEMA;

GRANT EXECUTE ON CTXSYS.CTX_CLS TO MYAIR_SCHEMA;
GRANT EXECUTE ON CTX_DDL TO MYAIR_SCHEMA;
GRANT EXECUTE ON CTXSYS.CTX_DOC TO MYAIR_SCHEMA;
GRANT EXECUTE ON CTXSYS.CTX_OUTPUT TO MYAIR_SCHEMA;
GRANT EXECUTE ON CTXSYS.CTX_QUERY TO MYAIR_SCHEMA;
GRANT EXECUTE ON CTXSYS.CTX_REPORT TO MYAIR_SCHEMA;
GRANT EXECUTE ON CTXSYS.CTX_THES TO MYAIR_SCHEMA;
GRANT EXECUTE ON CTXSYS.CTX_ULEXER TO MYAIR_SCHEMA;

GRANT CREATE TRIGGER TO MYAIR_SCHEMA;
grant DROP  USER TO MYAIR_SCHEMA;
CREATE USER AIR_SCHEMA IDENTIFIED BY 123;
GRANT CREATE ANY INDEX TO AIR_SCHEMA;
GRANT CREATE procedure TO AIR_SCHEMA;
GRANT CREATE TRIGGER TO AIR_SCHEMA;
GRANT CREATE session TO AIR_SCHEMA;
GRANT CREATE ANY table TO AIR_SCHEMA;
GRANT UNLIMITED TABLESPACE TO AIR_SCHEMA;
GRANT CREATE ROLE TO  MYAIR_SCHEMA;
GRANT CREATE profile TO  MYAIR_SCHEMA;
GRANT ALTER SESSION TO AIR_SCHEMA;
DROP USER AIR_SCHEMA CASCADE;
begin
    ctx_ddl.create_preference('my_wordlist','BASIC_WORDLIST');
    ctx_ddl.create_preference('my_lexer','AUTO_LEXER');
    ctx_ddl.set_attribute('my_lexer','INDEX_STEMS','YES');
end;

ALTER SESSION SET "_oracle_script"=true;

--USERS---
select * from dba_users;
CREATE PROFILE CLIENT_PROFILE limit
password_life_time unlimited
sessions_per_user 1000
FAILED_LOGIN_ATTEMPTS 5
PASSWORD_LOCK_TIME 1
PASSWORD_REUSE_TIME 10
PASSWORD_GRACE_TIME default
connect_time 180
idle_time 35;

select * from dba_profiles where profile = 'CLIENT_PROFILE';
DROP ROLE CLIENT_ROLE;
create role CLIENT_ROLE;
grant create session to CLIENT_ROLE;
GRANT CREATE SESSION TO CLIENT_ROLE WITH ADMIN OPTION;
grant execute on Booking_Ticket to CLIENT_ROLE;
grant execute on MYAIR_SCHEMA.Booking_Ticket to CLIENT_ROLE;

select * from dba_sys_privs where grantee = 'CLIENT_ROLE';
SELECT * FROM dba_tab_privs WHERE grantee = 'CLIENT_ROLE' AND privilege = 'EXECUTE';


create user AIR_CLIENT identified by 123
DEFAULT TABLESPACE TS_AIR
profile CLIENT_PROFILE
account unlock;

grant CLIENT_ROLE to AIR_CLIENT;
commit;

CREATE PROFILE MANAGER_PROFILE limit
password_life_time 90
sessions_per_user 3
FAILED_LOGIN_ATTEMPTS 3
PASSWORD_LOCK_TIME 2
PASSWORD_REUSE_TIME 10
PASSWORD_GRACE_TIME default
connect_time 240
idle_time 45;
drop role manager_role;
create role MANAGER_ROLE;
grant create session to MANAGER_ROLE;

ALTER SYSTEM DISABLE RESTRICTED SESSION;

DROP USER AIR_CLIENT;

ALTER SYSTEM ENABLE RESTRICTED SESSION;
DROP USER AIR_MANAGER;

create user AIR_MANAGER identified by 2104
DEFAULT TABLESPACE TS_AIR
PROFILE MANAGER_PROFILE
account unlock;

grant MANAGER_ROLE to AIR_MANAGER;
commit;

alter user system default tablespace TS_AIR;
alter user system quota unlimited on TS_AIR;
commit;
